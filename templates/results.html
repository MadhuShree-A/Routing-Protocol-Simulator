<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Routing Tables</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body { font-family:'Roboto',sans-serif; background:#f4f6f8; color:#222; margin:0; padding:36px; text-align:center;}
    h1 { color:#1a73e8; margin-bottom:4px;}
    .subtitle { color:#666; margin-bottom:18px;}
    .controls { margin:18px 0; display:flex; gap:12px; justify-content:center; flex-wrap:wrap;}
    button { padding:10px 14px; border-radius:10px; border:none; cursor:pointer; font-weight:600; background:#1a73e8; color:#fff;}
    .secondary { background:#34a853; }
    .card { display:inline-block; text-align:left; width:420px; background:#fff; padding:22px; border-radius:12px; box-shadow:0 8px 24px rgba(20,20,40,0.06); margin:12px; vertical-align:top;}
    table { width:100%; border-collapse:collapse; margin-top:8px; }
    th, td { padding:8px 10px; border-bottom:1px solid #eee; text-align:center; }
    th { background:#1a73e8; color:white; font-weight:600; }
    .dv th { background:#34a853; }
    a.back { display:inline-block; margin-top:24px; text-decoration:none; color:#1a73e8; font-weight:600; padding:10px 18px; border-radius:10px; border:2px solid #1a73e8;}
    .export { background:#6c757d; }
    @media(max-width:900px){ .card{ width:90%; } .controls{ flex-direction:column; } }
  </style>
</head>
<body>
  <h1>Routing Tables</h1>
  <div class="subtitle">Algorithm run: <strong>{{ algorithm|capitalize }}</strong></div>

  <div class="controls">
    <button onclick="downloadCSV('dijkstra')">Export Dijkstra CSV</button>
    <button onclick="downloadCSV('bellmanford')" class="secondary">Export Bellman-Ford CSV</button>
    <button onclick="downloadBoth()" class="export">Export Combined CSV</button>
    <button onclick="downloadJSON()">Export JSON</button>
    <button onclick="window.location.href='/visualize'">ðŸ”Ž Visualize</button>
    <button onclick="window.location.href='/'" style="background:#fff;color:#1a73e8;border:2px solid #1a73e8;">â¬… Back</button>
  </div>

  <div style="display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin-top:18px;">
    {% if ls and (algorithm == 'dijkstra' or algorithm == 'both') %}
      <div class="card">
        <h3>Link State (OSPF â€” Dijkstra)</h3>
        {% for node, table in ls.items() %}
          <h4 style="margin-bottom:6px;">Router R{{ node }}</h4>
          <table>
            <tr><th>Destination</th><th>NextHop</th><th>Cost</th></tr>
            {% for row in table %}
              <tr>
                <td>{{ row.Destination }}</td>
                <td>{{ row.NextHop }}</td>
                <td>{{ row.Cost }}</td>
              </tr>
            {% endfor %}
          </table>
        {% endfor %}
      </div>
    {% endif %}

    {% if dv and (algorithm == 'bellmanford' or algorithm == 'both') %}
      <div class="card">
        <h3>Distance Vector (RIP â€” Bellman-Ford)</h3>
        {% for node, table in dv.items() %}
          <h4 style="margin-bottom:6px;">Router R{{ node }}</h4>
          <table class="dv">
            <tr><th>Destination</th><th>NextHop</th><th>Cost</th></tr>
            {% for row in table %}
              <tr>
                <td>{{ row.Destination }}</td>
                <td>{{ row.NextHop }}</td>
                <td>{{ row.Cost }}</td>
              </tr>
            {% endfor %}
          </table>
        {% endfor %}
      </div>
    {% endif %}
  </div>

  <a class="back" href="/">â¬… Back to Topology Builder</a>

  <script>
    function downloadCSV(alg){
      // opens /export/<alg> endpoint
      window.location.href = '/export/' + alg;
    }
    function downloadBoth(){
      window.location.href = '/export/both';
    }
    function downloadJSON(){
      window.location.href = '/export_json';
    }
  </script>
</body>
</html>
